<div class="sidebar-wrapper">
  <div class="d-flex flex-column flex-shrink-0 sidebar-main h-100">

    <!-- HEADER -->
    <div class="sidebar-header">
      <a href="/" class="d-flex align-items-center text-white text-decoration-none">
        <i class="fas fa-industry me-2 fs-5"></i>
        <span class="sidebar-brand-text">HSK PRO</span>
      </a>
    </div>

    <hr class="sidebar-divider my-0" />

    <!-- USER INFO -->
    <div class="sidebar-user">
      <div class="user-avatar">
        <i class="fas fa-user-tie"></i>
      </div>
      <div class="user-info ms-2">
        <p class="user-name mb-0">{{ (authService.currentUser())?.username }}</p>
        <small class="user-status">
          <i class="fas fa-circle text-success"></i> Online
        </small>
      </div>
    </div>

    <hr class="sidebar-divider my-2" />

    <!-- MENU NAV -->
    <nav class="sidebar-nav flex-grow-1">
      <div class="nav-section-label">MENU</div>

      <div *ngFor="let item of menuItems">

        <!-- DIRECT LINKS (tanpa children) -->
        <ng-container *ngIf="!item.children && hasPermission(item.roles)">
          <a [routerLink]="item.route"
             routerLinkActive="active"
             [routerLinkActiveOptions]="{exact: true}"
             class="nav-link"
             [attr.data-menu]="item.label"
             [title]="isCollapsed() ? item.label : ''">
            <i [class]="item.icon + ' nav-icon'"></i>
            <span class="nav-text">{{ item.label }}</span>
          </a>
        </ng-container>

        <!-- SUBMENU (dengan children) -->
        <ng-container *ngIf="item.children && hasPermission(item.roles)">
          <div class="nav-link-wrapper" (mouseenter)="onMenuMouseEnter(item)" (mouseleave)="onMenuMouseLeave()">
            <a href="javascript:void(0)"
               class="nav-link"
               [attr.data-menu]="item.label"
               (click)="toggleMenu(item.label, $event)"
               [title]="isCollapsed() ? item.label : ''"
               [ngClass]="{ 'expanded': isMenuExpanded(item.label) }">
              <i [class]="item.icon + ' nav-icon'"></i>
              <span class="nav-text">{{ item.label }}</span>
              <i class="fas fa-chevron-right nav-chevron"></i>
            </a>

            <!-- SUBMENU ITEMS - Normal Expanded -->
            <div class="nav-submenu" [ngClass]="{ 'show': isMenuExpanded(item.label) }">
              <a *ngFor="let child of item.children"
                 [routerLink]="child.route"
                 routerLinkActive="active"
                 [routerLinkActiveOptions]="{exact: true}"
                 class="nav-link nav-link-submenu">
                <i [class]="child.icon + ' nav-icon-sub'"></i>
                <span class="nav-text">{{ child.label }}</span>
              </a>
            </div>

            <!-- HOVER SUBMENU - For Collapsed State -->
            <div class="nav-hover-submenu" *ngIf="isCollapsed() && isMenuHovered(item.label)">
              <div class="hover-submenu-header">
                <i [class]="item.icon"></i>
                <span>{{ item.label }}</span>
              </div>
              <a *ngFor="let child of item.children"
                 [routerLink]="child.route"
                 routerLinkActive="active"
                 [routerLinkActiveOptions]="{exact: true}"
                 class="hover-submenu-item">
                <i [class]="child.icon"></i>
                <span>{{ child.label }}</span>
              </a>
            </div>
          </div>
        </ng-container>

      </div>

    </nav>

    <hr class="sidebar-divider my-2" />

    <!-- FOOTER -->
    <div class="sidebar-footer">
      <small class="text-muted d-block text-center">
        <i class="fas fa-info-circle"></i> Need Help?
      </small>
    </div>

  </div>
</div>